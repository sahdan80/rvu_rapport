left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning),
"Tot" = sum(.)) %>%
spread(answer, antal) %>%
replace(is.na(.),0)
svarsnyckel <- labels_data %>%
filter(question_id=="H5") %>%
select(answer_id,answer)
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning),
"Tot" = sum(n())) %>%
spread(answer, antal) %>%
replace(is.na(.),0)
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(Tot = sum(2:5))
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(Tot = rowSums(select_if(., is.numeric), na.rm = TRUE)))
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(Tot = rowSums(select_if(., is.numeric), na.rm = TRUE))
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0)
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(Tot = rowSums())
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(Tot = rowSums(across(where(is.numeric))))
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(Tot = rowSums(across(where(is.numeric)))-Befolkning)
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(total = sum(c_across(2:5))) %>%
ungroup() %>%
mutate(across(2:5, ~ . / total))
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(total = sum(c_across(3:7))) %>%
ungroup() %>%
mutate(across(3:7, ~ . / total))
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(total = sum(c_across(3:8))) %>%
ungroup() %>%
mutate(across(3:8, ~ . / total))
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(total = sum(c_across(3:7))) %>%
ungroup() %>%
mutate(across(3:7, ~ . / total))
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(total = sum(c_across(3:8))) %>%
ungroup() %>%
mutate(across(3:8, ~ . / total))
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(total = sum(c_across(3:8))) %>%
ungroup()
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0)
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(total = sum(c_across(3:7)))
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(total = sum(c_across(2:7)))
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(total = rowSums(across(where(is.numeric)))-Befolkning)
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(total = rowSums(across(where(is.numeric)))-Befolkning) %>%
ungroup() %>%
mutate(across(3:8, ~ . / total))
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(total = rowSums(across(where(is.numeric)))-Befolkning) %>%
ungroup() %>%
mutate(across(where(is.numeric), ~ . / total))
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(total = rowSums(across(where(is.numeric)))-Befolkning) %>%
ungroup() %>%
mutate(across(where(is.numeric)!Befolkning, ~ . / total))
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(total = rowSums(across(where(is.numeric)))-Befolkning) %>%
ungroup() %>%
mutate(across(where(is.numeric & !Befolkning), ~ . / total))
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(total = rowSums(across(where(is.numeric)))-Befolkning) %>%
ungroup() %>%
mutate(across(where(is.numeric) & !Befolkning, ~ . / total))
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(total = rowSums(across(where(is.numeric)))-Befolkning) %>%
ungroup() %>%
mutate(across(where(is.numeric) & !Befolkning, ~ . / total)) %>%
select(!Befolkning)
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(total = rowSums(across(where(is.numeric)))-Befolkning) %>%
ungroup() %>%
mutate(across(where(is.numeric) & !Befolkning, ~ . / total)) %>%
select(!Befolkning&!total)
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(total = rowSums(across(where(is.numeric)))-Befolkning) %>%
ungroup() %>%
mutate(across(where(is.numeric) & !Befolkning, ~ . / total)) %>%
select(!Befolkning&!total) %>%
mutate(across(where(is.numeric), ~percent(.x, accuracy = 1)))
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(total = rowSums(across(where(is.numeric)))-Befolkning) %>%
ungroup() %>%
mutate(across(where(is.numeric) & !Befolkning, ~ . / total))
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(total = rowSums(across(where(is.numeric)))-Befolkning) %>%
ungroup() %>%
mutate(across(where(is.numeric) & !Befolkning, ~ . / total)) %>%
select(!total)
trip_sys_mode_percent <- trip_sys_mode %>%
select(!Befolkning)
mutate(across(where(is.numeric), ~percent(.x, accuracy = 1)))
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(total = rowSums(across(where(is.numeric)))-Befolkning) %>%
ungroup() %>%
mutate(across(where(is.numeric) & !Befolkning, ~ . / total)) %>%
select(!total)
trip_sys_mode_percent <- trip_sys_mode %>%
select(!Befolkning) %>%
mutate(across(where(is.numeric), ~percent(.x, accuracy = 1)))
trip_sys_mode_abs <- trip_sys_mode %>%
mutate(across(where(is.numeric) & !Befolkning, ~ . * Befolkning))
View(trip_sys_mode_abs)
View(trip_sys_mode_percent)
trip_sys_mode_abs <- trip_sys_mode %>%
mutate(across(where(is.numeric) & !Befolkning, ~ round(. * Befolkning)))
trip_sys_mode_abs <- trip_sys_mode %>%
mutate(across(where(is.numeric) & !Befolkning, ~ round(. * Befolkning)),
Totalt = Befolkning) %>%
select(!Befolkning)
trip_sys_mode_abs <- trip_sys_mode %>%
mutate(across(where(is.numeric) & !Befolkning, ~ round(. * Befolkning)),
Totalt = Befolkning) %>%
select(!Befolkning) %>%
mutate(across(where(is.numeric & . < 10), ~ "<10"))
trip_sys_mode_abs <- trip_sys_mode %>%
mutate(across(where(is.numeric) & !Befolkning, ~ round(. * Befolkning)),
Totalt = Befolkning) %>%
select(!Befolkning) %>%
mutate(across(where(. < 10), ~ "<10"))
trip_sys_mode_abs <- trip_sys_mode %>%
mutate(across(where(is.numeric) & !Befolkning, ~ round(. * Befolkning)),
Totalt = Befolkning) %>%
select(!Befolkning) %>%
mutate(across(where(<10), ~ "<10"))
trip_sys_mode_abs <- trip_sys_mode %>%
mutate(across(where(is.numeric) & !Befolkning, ~ round(. * Befolkning)),
Totalt = Befolkning) %>%
select(!Befolkning) %>%
mutate(across(where(is.numeric), ~ "X"))
svarsnyckel <- labels_data %>%
filter(question_id=="H5") %>%
select(answer_id,answer)
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(total = rowSums(across(where(is.numeric)))-Befolkning) %>%
ungroup() %>%
mutate(across(where(is.numeric) & !Befolkning, ~ . / total)) %>%
select(!total)
trip_sys_mode_percent <- trip_sys_mode %>%
select(!Befolkning) %>%
mutate(across(where(is.numeric), ~percent(.x, accuracy = 1)))
trip_sys_mode_abs <- trip_sys_mode %>%
mutate(across(where(is.numeric) & !Befolkning, ~ round(. * Befolkning)),
Totalt = Befolkning) %>%
select(!Befolkning)
svarsnyckel <- labels_data %>%
filter(question_id=="H5") %>%
select(answer_id,answer)
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(total = rowSums(across(where(is.numeric)))-Befolkning) %>% #Räknar ut radsummor
bind_rows(summarize(.,
across(where(is.numeric), sum),
across(where(is.character), ~ "Total"))) %>% #Skapar totalrad
ungroup() %>%
mutate(across(where(is.numeric) & !Befolkning, ~ . / total)) %>% #dividerar till procent av respondenter
select(!total)
trip_sys_mode_percent <- trip_sys_mode %>%
select(!Befolkning) %>%
mutate(across(where(is.numeric), ~percent(.x, accuracy = 1)))
trip_sys_mode_abs <- trip_sys_mode %>%
mutate(across(where(is.numeric) & !Befolkning, ~ round(. * Befolkning)),
Totalt = Befolkning) %>%
select(!Befolkning)
svarsnyckel <- labels_data %>%
filter(question_id=="H5") %>%
select(answer_id,answer)
trip_sys_mode <- rvu %>%
left_join(select(pers, c("respondentid","h5")), by = c("respondentid" = "respondentid")) %>% #Hämtar kolumn h5 från pers-data %>%
select(Område, Område_kod, h5, fardmedel.kat) %>%
filter(!is.na(fardmedel.kat)) %>%
left_join(svarsnyckel, by = c("h5" = "answer_id")) %>%
left_join(select(deso_befolkning, c(Område_kod,Befolkning)), by = c("Område_kod" = "Område_kod")) %>%
group_by(Område,answer) %>%
summarize(antal = n(),
"Befolkning" = first(Befolkning)) %>%
spread(answer, antal) %>%
replace(is.na(.),0) %>%
mutate(total = rowSums(across(where(is.numeric)))-Befolkning) %>% #Räknar ut radsummor
ungroup() %>%
bind_rows(summarize(.,
across(where(is.numeric), sum),
across(where(is.character), ~ "Total"))) %>% #Skapar totalrad
mutate(across(where(is.numeric) & !Befolkning, ~ . / total)) %>% #dividerar till procent av respondenter
select(!total)
trip_sys_mode_percent <- trip_sys_mode %>%
select(!Befolkning) %>%
mutate(across(where(is.numeric), ~percent(.x, accuracy = 1)))
trip_sys_mode_abs <- trip_sys_mode %>%
mutate(across(where(is.numeric) & !Befolkning, ~ round(. * Befolkning)),
Totalt = Befolkning) %>%
select(!Befolkning)
